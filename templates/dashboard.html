{% extends 'base.html' %}

{% block header_title %}dashboard{% endblock %}

{% block content %}
<section class="max-w-7xl mx-auto fade-in">
    <!-- Stats Cards (Оставляем статичными для примера, но можно обновить так же) -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        <div class="glass-panel p-5 rounded-xl border border-[#2c2f3b] relative overflow-hidden group">
            <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                <i data-lucide="flag" class="w-16 h-16 text-[#9fef00]"></i>
            </div>
            <p class="text-[#5a6278] text-xs font-bold uppercase tracking-widest mb-1">Owned Flags</p>
            <h3 class="text-3xl font-bold text-white font-mono">{{ owned_flags }} <span class="text-lg text-[#5a6278]">/ {{ total_flags }}</span></h3>
        </div>
        <!-- ... другие карточки ... -->
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Main Panel -->
        <div class="lg:col-span-2 glass-panel p-6 rounded-xl border border-[#2c2f3b]">
            <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                <i data-lucide="terminal" class="w-5 h-5 text-[#9fef00]"></i> Mission Status
            </h3>
            <div class="h-64 flex items-center justify-center border border-dashed border-[#2c2f3b] rounded-lg bg-[#0d0e12]/50">
                <p class="text-[#5a6278] font-mono text-sm">System operational. Awaiting input.</p>
            </div>
        </div>

        <!-- Activity Log (REAL TIME) -->
        <div class="glass-panel p-6 rounded-xl border border-[#2c2f3b] h-[500px] flex flex-col">
            <h3 class="text-lg font-bold text-white mb-4 flex items-center gap-2">
                <i data-lucide="activity" class="w-5 h-5 text-[#9fef00]"></i> Live Activity
                <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse ml-auto"></div>
            </h3>

            <!-- HTMX Container -->
            <!-- hx-get: URL для получения обновлений -->
            <!-- hx-trigger: событие 'data_refresh' (от WebSockets) запускает обновление -->
            <div id="activity-log-container"
                 class="overflow-y-auto pr-2 custom-scrollbar flex-1"
                 hx-get="{% url 'dashboard' %}"
                 hx-trigger="data_refresh from:body"
                 hx-swap="innerHTML">

                {% include 'partials/dashboard_data.html' %}

            </div>
        </div>
    </div>
</section>
{% endblock %}